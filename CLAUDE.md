# CLAUDE.md

This file provides guidance to Claude Code (claude.ai/code) when working with code in this repository.

## Project Overview

This is an Agile Sprint Retrospective Tool - a React application for creating collaborative retrospective boards for agile teams. The application allows teams to create real-time collaborative boards using different retrospective templates (Start/Stop/Continue, Mad/Sad/Glad, 4 L's).

## Common Development Commands

```bash
# Install dependencies
npm i

# Start development server
npm run dev

# Build for production
npm run build

# Build in development mode
npm run build:dev

# Run linting
npm run lint

# Preview production build
npm run preview
```

## Tech Stack & Architecture

- **Frontend**: React 18 with TypeScript, Vite build tool
- **UI**: shadcn/ui components with Tailwind CSS
- **Routing**: React Router DOM with routes: `/` (home), `/board/:boardId` (board view)
- **State Management**: TanStack Query for server state, React hooks for local state
- **Database**: Supabase (PostgreSQL) with real-time subscriptions
- **Authentication**: Session-based with auto-generated session IDs

## Key Components Architecture

### Application Structure
- `App.tsx`: Root component with routing, query client, and toast providers
- `pages/Index.tsx`: Home page for creating new retrospective boards
- `pages/Board.tsx`: Individual board view with real-time collaboration
- `components/retro/`: Retrospective-specific components (RetroBoard, RetroColumn, RetroCard, BoardHeader)

### Database Integration
- Supabase client configured in `src/integrations/supabase/client.ts`
- Real-time subscriptions for live collaboration on cards and votes
- Main tables: `boards`, `retro_cards`, `votes`, `board_participants`
- Board participants are tracked with session IDs and last-seen timestamps

### Real-time Features
- Live card updates using Supabase real-time subscriptions
- Anonymous voting system on cards
- Participant tracking with periodic heartbeat updates
- Fallback polling every 5 seconds as backup for real-time updates

## Board Templates

The application supports three retrospective templates:
1. **Start/Stop/Continue**: Classic format with green/red/blue columns
2. **Mad/Sad/Glad**: Emotional reflection with red/yellow/green columns  
3. **4 L's**: Comprehensive learning format (Liked/Learned/Lacked/Longed For)

Templates are defined in `RetroBoard.tsx:getDefaultColumns()` and stored in board configuration.

## Development Notes

- Uses shadcn/ui component library extensively - check existing components before creating new ones
- All forms use react-hook-form with zod validation
- Toast notifications via sonner
- Color theming uses CSS custom properties for retro columns
- Session management is client-side only using crypto.randomUUID()
- Error boundaries handle Supabase connection issues gracefully

## Database Schema Notes

- Board IDs are 6-character uppercase strings generated by database triggers
- Cards have positions for ordering and belong to specific columns
- Votes are anonymous and tied to voter session IDs
- Board participants are soft-tracked (no authentication required)

## **1. Security Vulnerabilities (CRITICAL RISK)**
- **No authentication/authorization system** - Anyone can access/modify all data
- **Hardcoded API credentials** in source code
- **Missing input validation** - XSS vulnerabilities present
- **Unsafe board ID generation** - Only 2B possible combinations, easily enumerable